# ä½¿ç”¨YOLOv8è®­ç»ƒè‡ªå·±çš„æ•°æ®é›†ï¼ˆåŸç†è§£æ+æ•°æ®æ ‡æ³¨è¯´æ˜+è®­ç»ƒæ•™ç¨‹+å›¾å½¢åŒ–ç³»ç»Ÿå¼€å‘ï¼‰

## ä½¿ç”¨YOLOv8è®­ç»ƒè‡ªå·±çš„æ•°æ®é›†

Helloï¼Œå¤§å®¶å¥½ï¼Œæœ¬æ¬¡æˆ‘ä»¬æ¥æ•™å¤§å®¶ä½¿ç”¨YOLOV8è®­ç»ƒè‡ªå·±çš„æ•°æ®é›†ã€‚

> è§†é¢‘åœ°å€ï¼š[æ‰‹æŠŠæ‰‹æ•™ä½ ç”¨YOLOv8è®­ç»ƒè‡ªå·±çš„æ•°æ®é›†ï¼ˆåŸç†è§£æ+ä»£ç å®è·µï¼‰_å“”å“©å“”å“©_bilibili](https://www.bilibili.com/video/BV1KHp2eREFZ/?spm_id_from=333.999.0.0&vd_source=2f9a4e63109c3db3be5e8078e5111776)
> 
> GitHubèµ„æºåœ°å€ï¼š 

YOLOç³»åˆ—ç›®å‰å·²ç»æ›´æ–°åˆ°äº†V11ï¼Œå¹¶ä¸”YOLOç³»åˆ—æ¨¡å‹å·²ç»ç›®å‰ç¨³å®šè¿è¡Œäº†ä¸€æ®µæ—¶é—´ã€‚ ä»åŸç†ã€æ•°æ®æ ‡æ³¨å’Œç¯å¢ƒé…ç½® ï¼Œå¸®åŠ©å°ä¼™ä¼´ä»¬æŒæ¡YOLOv8çš„åŸºæœ¬å†…å®¹ã€‚æ³¨æ„æœ¬æ¬¡çš„æ•™ç¨‹é™¤äº†æ”¯æŒv8æ¨¡å‹çš„è®­ç»ƒï¼Œè¿˜é€‚ç”¨v3ã€v5ã€v9ã€v10ç­‰ä¸€ç³»åˆ—æ¨¡å‹çš„è®­ç»ƒã€‚

ä¸ºäº†å¸®åŠ©å¤§å®¶èƒ½çµæ´»é€‰æ‹©è‡ªå·±å–œæ¬¢çš„å†…å®¹ï¼Œæˆ‘ä»¬é€‰æ‹©åˆ†Pçš„æ–¹å¼è¿›è¡Œæ›´æ–°ã€‚æ¯”å¦‚ï¼Œæœ‰çš„å°ä¼™ä¼´åªå–œæ¬¢ç†è®ºçš„éƒ¨åˆ†ï¼Œæœ‰çš„å°ä¼™ä¼´åªå–œæ¬¢å®æ“çš„éƒ¨åˆ†ï¼Œè¿™æ ·å¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦å„å–æ‰€éœ€ã€‚

![image-20240818153803760](https://i-blog.csdnimg.cn/blog_migrate/5d0e99275e7f292a39b00e37d35bde6b.png)



### YOLOv8åŸç†è§£æ

![yolov8ç½‘ç»œç»“æ„å›¾](ä½¿ç”¨YOLOv8è®­ç»ƒè‡ªå·±çš„æ•°æ®é›†_åŸç†è§£æ_æ•°æ®æ ‡æ³¨è¯´æ˜_è®­ç»ƒæ•™ç¨‹_å›¾å½¢åŒ–ç³»ç»Ÿå¼€å‘_.assets/yolov8ç½‘ç»œç»“æ„å›¾.jpg)

Ultralyticså¼€å‘çš„YOLOv8æ˜¯ä¸€æ¬¾å°–ç«¯ã€æœ€å…ˆè¿›ï¼ˆSOTAï¼‰çš„æ¨¡å‹ï¼Œå®ƒå€Ÿé‰´äº†ä¹‹å‰YOLOç‰ˆæœ¬çš„æˆåŠŸç»éªŒï¼Œå¹¶å¼•å…¥äº†æ–°çš„ç‰¹æ€§å’Œæ”¹è¿›ï¼Œä»¥è¿›ä¸€æ­¥æé«˜æ€§èƒ½å’Œçµæ´»æ€§ã€‚YOLOv8æ—¨åœ¨å®ç°å¿«é€Ÿã€å‡†ç¡®å’Œæ˜“äºä½¿ç”¨ï¼Œå› æ­¤æ˜¯å„ç§ç›®æ ‡æ£€æµ‹ã€å›¾åƒåˆ†å‰²å’Œå›¾åƒåˆ†ç±»ä»»åŠ¡çš„ç»ä½³é€‰æ‹©ã€‚æ³¨æ„ï¼Œæ­¤æ—¶çš„YOLOv8çš„æ¨¡å‹å·²ç»åŸºæœ¬å®Œæˆäº†æœ€ç»ˆçš„è¿›åŒ–ï¼Œé™¤äº†æ”¯æŒæœ€ç»å…¸çš„ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¹‹å¤–ï¼Œè¿˜æ·»åŠ äº†å¯¹è¯­ä¹‰åˆ†å‰²ã€åˆ†ç±»å’Œè¿½è¸ªç­‰ä»»åŠ¡çš„æ”¯æŒã€‚å½“ç„¶æˆ‘ä»¬æœ¬æœŸè¿˜æ˜¯é€‰æ‹©å¤§å®¶æœ€ç†Ÿæ‚‰çš„æ£€æµ‹ä»»åŠ¡æ¥è¿›è¡Œå±•å¼€ï¼Œå…³äºåç»­çš„å…¶ä»–ä»»åŠ¡æˆ‘ä»¬å†å¦å¤–å½•åˆ¶ã€‚

![Ultralytics YOLO supported tasks](https://i-blog.csdnimg.cn/blog_migrate/dd63b942078b1adb77bef945e43218a8.png)

é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹YOLOv8ç®—æ³•çš„æ€§èƒ½ã€‚ä¸‹å›¾æ˜¯å®˜æ–¹æä¾›äº†æ€§èƒ½å›¾ï¼Œå…¶ä¸­å·¦å›¾çš„æ¨ªåæ ‡è¡¨ç¤ºçš„æ˜¯ç½‘ç»œçš„å‚æ•°é‡ï¼Œå³å›¾çš„æ¨ªåæ ‡è¡¨ç¤ºçš„ç½‘ç»œåœ¨A100æ˜¾å¡ä¸Šçš„æ¨ç†é€Ÿåº¦ï¼Œçºµåæ ‡æ–¹é¢è¡¨ç¤ºè¡¨ç¤ºçš„éƒ½æ˜¯æ¨¡å‹çš„ç²¾åº¦ã€‚å¯ä»¥çœ‹å‡ºï¼ŒYOLOv8æ¨¡å‹çš„åœ¨åŒæ ·çš„å‚æ•°é‡ä¸‹ï¼Œæ¯”å…¶ä»–ç³»åˆ—çš„YOLOæ¨¡å‹æœ‰æ˜æ˜¾çš„ç²¾åº¦æå‡ï¼Œåœ¨å³å›¾å±•ç¤ºçš„åŒæ ·çš„mapç²¾åº¦ä¸‹ï¼ŒYOLOv8çš„æ¨¡å‹ä¹ŸåŒæ ·æœ‰æ›´å¿«çš„é€Ÿåº¦ï¼Œè¿˜çœŸå°±æ˜¯é‚£ä¸ªæ›´é«˜ã€æ›´å¿«ã€æ›´å¼ºã€‚

![Ultralytics YOLOv8](https://i-blog.csdnimg.cn/blog_migrate/bc15b1cf737d5c52cedc59d5403128b5.png)

ä¸‹é¢çš„è¡¨æ ¼åˆ™æ˜¯æ¥è‡ª[YOLOv8 - Ultralytics YOLO Docs](https://docs.ultralytics.com/models/yolov8/#overview)æä¾›çš„åœ¨cocoæ•°æ®é›†ä¸Šçš„æµ‹è¯•ç»“æœï¼Œä»è¡¨ä¸­å¯ä»¥çœ‹å‡ºï¼Œå¯¹äºä»–çš„nanoæ¨¡å‹è€Œè¨€ï¼Œåœ¨åªæœ‰3.2Mçš„å‚æ•°é‡ä¸‹ï¼Œå°±å¯ä»¥è¾¾åˆ°37.3çš„mAPï¼Œéå¸¸ä¼˜ç§€çš„æ•°å€¼è¡¨ç°ã€‚

![image-20240816165549221](https://i-blog.csdnimg.cn/blog_migrate/84bdd646c1e40ba856193b6b50b4918c.png)

YOLOv8ç®—æ³•çš„æ ¸å¿ƒç‚¹å¯ä»¥æ€»ç»“ä¸ºä¸‹é¢å‡ ç‚¹ã€‚

  1. **ç»™å‡ºäº†ä¸€ä¸ªå…¨æ–°çš„è§†è§‰æ¨¡å‹** ï¼Œä¿æŒç²¾åº¦çš„åŒæ—¶ï¼Œå®ç°äº†è¾ƒé«˜çš„æ£€æµ‹é€Ÿåº¦ï¼Œå¹¶ä¸”åŒæ—¶æ”¯æŒæ”¯æŒå›¾åƒåˆ†ç±»ã€ç‰©ä½“æ£€æµ‹å’Œå®ä¾‹åˆ†å‰²ç­‰å¤šç§è§†è§‰ä»»åŠ¡ã€‚å¹¶ä¸”æä¾›äº†å¤šä¸ªè§„æ¨¡çš„æ¨¡å‹ï¼ˆnanoã€smallã€mediumã€largeå’Œx-largeï¼‰ï¼Œæ»¡è¶³ç”¨æˆ·ä¸åŒåœºæ™¯çš„éœ€è¦ã€‚
  2.  **æ–°çš„éª¨å¹²ç½‘ç»œ** ï¼šYOLOv8å¼•å…¥äº†ä¸€ä¸ªæ–°çš„éª¨å¹²ç½‘ç»œï¼Œå¯èƒ½å‚è€ƒäº†YOLOv7 ELANè®¾è®¡æ€æƒ³ï¼Œå°†YOLOv5ä¸­çš„C3ç»“æ„æ¢æˆäº†æ¢¯åº¦æµæ›´ä¸°å¯Œçš„C2fç»“æ„ï¼Œå¹¶å¯¹ä¸åŒå°ºåº¦æ¨¡å‹è°ƒæ•´äº†ä¸åŒçš„é€šé“æ•°ï¼Œå¤§å¹…æå‡äº†æ¨¡å‹æ€§èƒ½ã€‚
  3.  **è§£è€¦å¤´çš„è®¾è®¡** ï¼šYOLOv8çš„Headéƒ¨åˆ†ä»åŸå…ˆçš„è€¦åˆå¤´å˜æˆäº†è§£è€¦å¤´ç»“æ„ï¼Œå°†åˆ†ç±»å’Œæ£€æµ‹å¤´åˆ†ç¦»ï¼Œå¹¶ä¸”ä»Anchor-Basedè½¬å˜ä¸ºAnchor-Freeï¼Œç®€åŒ–äº†æ¨¡å‹ç»“æ„å¹¶æé«˜äº†æ¨ç†é€Ÿåº¦ã€‚
  4.  **æ–°çš„æŸå¤±å‡½æ•°** ï¼šYOLOv8åœ¨Lossè®¡ç®—æ–¹é¢é‡‡ç”¨äº†TaskAlignedAssigneræ­£æ ·æœ¬åˆ†é…ç­–ç•¥ï¼Œå¹¶å¼•å…¥äº†Distribution Focal Lossï¼Œç¡®ä¿äº†æ£€æµ‹ç»“æœçš„å‡†ç¡®æ€§å’Œé²æ£’æ€§ã€‚

OKï¼Œè¯´å®Œè¿™é‡Œçš„æ€§èƒ½è¡¨ç°ï¼Œæˆ‘ä»¬å°±ä¸€èµ·æ¥çœ‹çœ‹YOLOv8ç»“æ„æ–¹é¢çš„å†…å®¹å§ã€‚

#### ç»“æ„è¯´æ˜

é¦–å…ˆæ˜¯YOLOv8çš„ç½‘ç»œç»“æ„å›¾

![222869864-1955f054-aa6d-4a80-aed3-92f30af28849](https://i-blog.csdnimg.cn/blog_migrate/0e919b97e4b64cfc32bf174c037164cc.jpeg)

  * éª¨å¹²ç½‘ç»œéƒ¨åˆ†ï¼š

éª¨å¹²ç½‘ç»œéƒ¨åˆ†çš„c2fç»“æ„å¯èƒ½å€Ÿé‰´äº†[YOLOv7](https://github.com/WongKinYiu/yolov7)çš„è®¾è®¡ã€‚å°†åŸå…ˆçš„c3æ¨¡å—æ›´æ–°äº†c2fçš„æ¨¡å—ï¼Œå…¶ä¸­c3è¡¨ç¤ºä½¿ç”¨äº†3ä¸ªå¸¸è§„çš„å·ç§¯æ¨¡å—ï¼Œc2fè¡¨ç¤ºä½¿ç”¨äº†2ä¸ªå·ç§¯æ¨¡å—å¹¶ä¸”æ›´å¿«ï¼ˆfastï¼‰ã€‚åœ¨ä¸æ”¹å˜åŸå§‹æ¶æ„å’Œæ¢¯åº¦ä¼ è¾“è·¯å¾„çš„å‰æä¸‹ï¼Œ ä½¿ç”¨åˆ†ç»„å·ç§¯è¸¢æ¥ä»¥åŠä½¿ç”¨æ´—ç‰Œå’Œåˆå¹¶çš„æ“ä½œç»„åˆä¸åŒç»„çš„ç‰¹å¾ï¼Œå¢å¼ºæ¨¡å‹ä»ä¸åŒç‰¹å¾å›¾ä¸­çš„å­¦ä¹ èƒ½åŠ›ï¼Œè¾¾åˆ°æ”¹å–„å‚æ•°çš„ä½œç”¨ã€‚

ä¸‹å›¾æ˜¯YOLOv7ä¸­åŸæ–‡æåˆ°çš„Elançš„ç»“æ„ï¼Œä¸»è¦æ˜¯ä½¿ç”¨äº†æ›´å¤šçš„è¿æ¥å’Œåˆå¹¶çš„æ“ä½œã€‚

![image-20240816171847228](https://i-blog.csdnimg.cn/blog_migrate/c27ed347dcd6c450d4ea97d76bf6bc38.png)

![module](https://i-blog.csdnimg.cn/blog_migrate/8cfd42013526828e7cf7a9702ce2a598.png)
    
```pyt
    class C3(nn.Module):
    """
    è¿™é‡Œæ˜¯ä½¿ç”¨äº†3ä¸ªå·ç§¯å±‚çš„cspç»“æ„
    CSP Bottleneck with 3 convolutions.
    """

    def __init__(self, c1, c2, n=1, shortcut=True, g=1, e=0.5):
        """Initialize the CSP Bottleneck with given channels, number, shortcut, groups, and expansion values."""
        super().__init__()
        c_ = int(c2 * e)  # hidden channels
        self.cv1 = Conv(c1, c_, 1, 1)
        self.cv2 = Conv(c1, c_, 1, 1)
        self.cv3 = Conv(2 * c_, c2, 1)  # optional act=FReLU(c2)
        self.m = nn.Sequential(*(Bottleneck(c_, c_, shortcut, g, k=((1, 1), (3, 3)), e=1.0) for _ in range(n)))

    def forward(self, x):
        """Forward pass through the CSP bottleneck with 2 convolutions."""
        return self.cv3(torch.cat((self.m(self.cv1(x)), self.cv2(x)), 1))
    
class C2f(nn.Module):
    """
    è¿™é‡Œä½¿ç”¨äº†åˆ†æ”¯å¤„ç†çš„æ“ä½œï¼Œä½¿ç”¨çš„æ˜¯é€šè¿‡å…³é—­æ®‹å·®é“¾æ¥çš„æ–¹å¼å®ç°
    å…ˆè¿›è¡Œåˆ†æ”¯çš„æ“ä½œç„¶åå†è¿›è¡Œç‰¹å¾èåˆçš„æ“ä½œ
    Faster Implementation of CSP Bottleneck with 2 convolutions.
    """

    def __init__(self, c1, c2, n=1, shortcut=False, g=1, e=0.5):
        """Initialize CSP bottleneck layer with two convolutions with arguments ch_in, ch_out, number, shortcut, groups,
        expansion.
        """
        super().__init__()
        self.c = int(c2 * e)  # hidden channels
        self.cv1 = Conv(c1, 2 * self.c, 1, 1)
        self.cv2 = Conv((2 + n) * self.c, c2, 1)  # optional act=FReLU(c2)
        self.m = nn.ModuleList(Bottleneck(self.c, self.c, shortcut, g, k=((3, 3), (3, 3)), e=1.0) for _ in range(n))

    def forward(self, x):
        """Forward pass through C2f layer."""
        y = list(self.cv1(x).chunk(2, 1))
        y.extend(m(y[-1]) for m in self.m)
        return self.cv2(torch.cat(y, 1))

    def forward_split(self, x):
        """Forward pass using split() instead of chunk()."""
        y = list(self.cv1(x).split((self.c, self.c), 1))
        y.extend(m(y[-1]) for m in self.m)
        return self.cv2(torch.cat(y, 1))
```


é™¤æ­¤ä¹‹å¤–ï¼ŒYOLOv8çš„ä¸»å¹²è¿˜å»æ‰äº†neckéƒ¨åˆ†ä¸­çš„2ä¸ªå·ç§¯å±‚ï¼Œä»¥åŠå°†blockçš„æ•°é‡ä»åŸå…ˆçš„ 3-6-9-3 æ”¹æˆäº† 3-6-6-3ã€‚å¦å¤–ï¼Œåœ¨ä¹‹å‰çš„YOLOv5çš„ç½‘ç»œç»“æ„ä¸­ï¼Œåªéœ€è¦æ›´æ”¹ä¸€ä¸‹wå’Œhç³»æ•°å°±èƒ½ç»Ÿä¸€é€‚é…ä¸åŒè§„æ¨¡çš„æ¨¡å‹ï¼Œä½†æ˜¯å¯¹äºYOLOv8è€Œè¨€ï¼Œå…¶ä¸­Nå’ŒSçš„ç»“æ„ä¸€è‡´ï¼ŒLå’ŒXçš„ç»“æ„ä¸€è‡´ï¼Œè¿™ä¸¤å¯¹æ¨¡å‹å¯ä»¥åªé€šè¿‡ä¿®æ”¹ç¼©æ”¾ç³»æ•°å°±å®Œæˆæ›¿æ¢ã€‚åœ¨YOLOv10ä¸­ï¼Œä½œè€…ä¹Ÿæåˆ°äº†è¿™ä¸ªè§‚ç‚¹ï¼Œä¸ºäº†è¿½æ±‚ç½‘ç»œçš„çµæ´»æ€§ï¼Œå¯¼è‡´ç½‘ç»œåŒè´¨åŒ–æ¯”è¾ƒä¸¥é‡ï¼Œå…¶ä¸­æœ‰äº›å†—ä½™çš„æ¨¡å—æ˜¯å¯ä»¥å»é™¤çš„ï¼Œä¹Ÿè¯´æ˜ç°åœ¨çš„ç½‘ç»œç»“æ„å‘ç€æ¯”è¾ƒå®šåˆ¶åŒ–çš„æ–¹å‘è¿›è¡Œï¼Œå½“ç„¶ï¼Œè¿™å¥è¯æ˜¯æˆ‘çš„ä¸ªäººè§‚ç‚¹ã€‚

  * è§£ç å¤´éƒ¨åˆ†ï¼š

è§£ç å¤´çš„éƒ¨åˆ†é€‰æ‹©ä½¿ç”¨äº†åˆ†ç±»çš„è§£ç å¤´ï¼Œä¹Ÿå°±æ˜¯è¾¹ç•Œæ¡†å›å½’æ˜¯ä¸€ä¸ªåˆ†æ”¯ä»¥åŠåˆ†ç±»çš„æ˜¯ä¸€ä¸ªåˆ†æ”¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸Šé¢çš„å­å›¾æ˜¯åŸå…ˆçš„è§£ç å¤´éƒ¨ï¼Œç»è¿‡ä¸»å¹²ç½‘ç»œè¿›è¡Œç‰¹å¾æå–ä¹‹åå¾—åˆ°ç‰¹å¾å›¾ï¼Œä¹‹åç›´æ¥è¿›å…¥ä¸€ä¸ªæ¨¡å—ä¸­è¿›è¡Œè§£ç ï¼Œè¿™é‡Œçš„æ•°å€¼è®¡ç®—åŒ…å«3ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ç”¨äºè¾¹ç•Œæ¡†å›å½’çš„CIoUã€ç”¨äºç½®ä¿¡åº¦è®¡ç®—çš„objå’Œç”¨äºåˆ†ç±»ç±»åˆ«è®¡ç®—çš„CLSã€‚æ”¹è¿›ä¹‹åçš„å¤´éƒ¨å¦‚ä¸‹é¢çš„å­å›¾æ‰€ç¤ºï¼Œç»è¿‡ä¸»å¹²ç½‘ç»œè¿›è¡Œç‰¹å¾æå–ä¹‹åï¼Œä¸Šé¢çš„å­åˆ†æ”¯ç”¨äºå›å½’ï¼Œä¸‹é¢çš„å­åˆ†æ”¯åˆ™ç”¨äºåˆ†ç±»ï¼Œå»é™¤äº†ä¹‹å‰çš„objçš„éƒ¨åˆ†ï¼Œåœ¨å›å½’çš„åˆ†æ”¯ä¸­ï¼Œä½¿ç”¨çš„æ˜¯Distribution Focal Lossã€‚

![head](https://i-blog.csdnimg.cn/blog_migrate/721a0c551fd978d3910d7960a77fa188.png)

å…¶ä¸­DFLæŸå¤±å‡½æ•°çš„å®šä¹‰å¦‚ä¸‹ï¼Œé€šä¿—æ¥è®²å°±æ˜¯è®­ç»ƒçš„è¿‡ç¨‹ä¸­ï¼Œç›®æ ‡çš„è¾¹ç•Œæ¡†ä¸åº”è¯¥æ˜¯ä¸€ä¸ªç¡®å®šçš„æ•°å€¼ï¼Œç›®æ ‡çš„è¾¹ç•Œæ¡†åº”è¯¥æ˜¯ä¸€ä¸ªåˆ†å¸ƒï¼Œæ¯”å¦‚å¯¹äºæµªèŠ±è¿™ä¸ªç‰©ä½“è€Œè¨€ï¼Œä»–çš„è¾¹ç•Œå°±æ˜¯ä¸æ¸…æ™°çš„ï¼Œé€šè¿‡è¿™æ ·çš„æŸå¤±å‡½æ•°å¯ä»¥å‡å°‘ç½‘ç»œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å‡ºç°çš„è¿‡æ‹Ÿåˆçš„ç°è±¡ã€‚

![image-20240816235150126](https://i-blog.csdnimg.cn/blog_migrate/eca6703ecfc4e6f35ea23584c984cb5e.png)

å…¶ä¸­ï¼ŒDFLå®ç°çš„ä»£ç å¦‚ä¸‹ï¼š
    
```python
    def distribution_focal_loss(pred, label):
    r"""Distribution Focal Loss (DFL) is from `Generalized Focal Loss: Learning
    Qualified and Distributed Bounding Boxes for Dense Object Detection
    <https://arxiv.org/abs/2006.04388>`_.

    Args:
        pred (torch.Tensor): Predicted general distribution of bounding boxes
            (before softmax) with shape (N, n+1), n is the max value of the
            integral set `{0, ..., n}` in paper.
        label (torch.Tensor): Target distance label for bounding boxes with
            shape (N,).

    Returns:
        torch.Tensor: Loss tensor with shape (N,).
    """
    #labelä¸ºy, predä¸ºy^(yçš„ä¼°è®¡å€¼ï¼‰
    #å› ä¸ºy_i <= y <= y_i+1(paper)
    #å–dis_left = y_i, dis_right = y_i+1
    dis_left = label.long()
    dis_right = dis_left + 1
    weight_left = dis_right.float() - label #y_i+1-y
    weight_right = label - dis_left.float() #y-y_i
    #paperä¸­çš„log(S)è¿™é‡Œç”¨CE
    loss = (
        F.cross_entropy(pred, dis_left, reduction="none") * weight_left
        + F.cross_entropy(pred, dis_right, reduction="none") * weight_right
    )
    return loss
```


#### æŸå¤±å‡½æ•°è¯´æ˜

YOLOv8çš„lossè®¡ç®—åŒ…å«äº†åˆ†ç±»å’Œå›å½’ä¸¤ä¸ªéƒ¨åˆ†ï¼Œæ²¡æœ‰äº†ä¹‹å‰çš„objectnessçš„åˆ†æ”¯éƒ¨åˆ†ï¼Œå…¶ä¸­åˆ†ç±»çš„åˆ†æ”¯é‡‡ç”¨çš„æ˜¯BCE Lossï¼Œå›å½’çš„åˆ†æ”¯ä½¿ç”¨äº†ä¸¤ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ä¸Šé¢æåˆ°çš„Distribution Focal Losså’ŒCIoU Lossï¼Œ3ä¸ªæŸå¤±å‡½æ•°æŒ‰ç…§ä¸€å®šçš„æƒé‡æ¯”ä¾‹è¿›è¡ŒåŠ æƒã€‚

å…³äºæ­£è´Ÿæ ·æœ¬çš„åˆ†é…ï¼Œå…¶ä¸­YOLOv5ä¸­ä½¿ç”¨çš„æ˜¯é™æ€çš„åˆ†å¸ƒç­–ç•¥ï¼Œç®€å•æ¥è¯´ï¼Œé™æ€çš„åˆ†å¸ƒç­–ç•¥æ˜¯å°†æ ‡ç­¾ä¸­çš„GT Boxå’ŒAnchor Templatesæ¨¡æ¿è®¡ç®—IoUï¼Œå¦‚æœIoUå¤§äºè®¾å®šçš„é˜ˆå€¼å°±è®¤ä¸ºæ˜¯åŒ¹é…æˆåŠŸï¼ŒåŒ¹é…æˆåŠŸçš„è¾¹ç•Œæ¡†å°†ä¼šå‚ä¸åˆ°CIoU Lossçš„è®¡ç®—ä¸­ã€‚å½“ç„¶è¿™é‡Œæ‰€è¿°çš„æ˜¯ç®€åŒ–çš„ç‰ˆæœ¬ï¼Œå®é™…å­è®¡ç®—çš„è¿‡ç¨‹ä¸­è¿˜ä¼šå»è®¡ç®—GT Boxå’Œå¯¹åº”çš„çš„Anchor Templatesæ¨¡æ¿é«˜å®½çš„æ¯”ä¾‹ã€‚å‡è®¾å¯¹æŸä¸ªGT Boxè€Œè¨€ï¼Œå…¶å®åªè¦GT Boxæ»¡è¶³åœ¨æŸä¸ªAnchor Templateå®½å’Œé«˜çš„Ã— 0.25 0.25å€å’Œ4.0å€ä¹‹é—´å°±ç®—åŒ¹é…æˆåŠŸã€‚å…³äºè¿™éƒ¨åˆ†æ›´è¯¦ç»†çš„è§£é‡Šå¯ä»¥çœ‹[YOLOv5ç½‘ç»œè¯¦è§£_yolov5ç½‘ç»œç»“æ„è¯¦è§£-CSDNåšå®¢](https://blog.csdn.net/qq_37541097/article/details/123594351?spm=1001.2014.3001.5501)ã€‚åœ¨YOLOv8ä¸­ï¼Œä½¿ç”¨çš„æ˜¯åŠ¨æ€åˆ†å¸ƒçš„ç­–ç•¥ï¼ˆYOLOX çš„ simOTAã€TOOD çš„ TaskAlignedAssigner å’Œ RTMDet çš„ DynamicSoftLabelAssignerï¼‰ï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨çš„æ˜¯ TOOD çš„ TaskAlignedAssignerã€‚ TaskAlignedAssigner çš„åŒ¹é…ç­–ç•¥ç®€å•æ€»ç»“ä¸ºï¼š æ ¹æ®åˆ†ç±»ä¸å›å½’çš„åˆ†æ•°åŠ æƒçš„åˆ†æ•°é€‰æ‹©æ­£æ ·æœ¬ã€‚

![image-20240817001553493](https://i-blog.csdnimg.cn/blog_migrate/a74e8731777476c1b86a1750d1b05553.png)

sæ˜¯æ ‡æ³¨ç±»åˆ«å¯¹åº”çš„é¢„æµ‹åˆ†æ•°å€¼ï¼Œuæ˜¯é¢„æµ‹æ¡†å’Œgtæ¡†ä¹‹é—´çš„iouã€‚è®¡ç®—å‡ºåˆ†æ•°ä¹‹åï¼Œæ ¹æ®åˆ†æ•°é€‰å–topKå¤§çš„ä½œä¸ºæ­£æ ·æœ¬ï¼Œå…¶ä½™ä½œä¸ºè´Ÿæ ·æœ¬ã€‚

#### æ•°æ®å¢å¼ºè¯´æ˜

æ•°æ®å¢å¼ºçš„éƒ¨åˆ†å’ŒYOLOv5åŸºæœ¬ä¿æŒäº†ä¸€è‡´ï¼ŒåŒ…å«äº†é¢œè‰²å˜æ¢ã€é©¬èµ›å…‹æ•°æ®å¢å¼ºã€éšæœºå‰ªåˆ‡ç­‰ä¸€ç³»åˆ—å¸¸è§„çš„æ•°æ®å¢å¼ºçš„æ–¹å¼ã€‚å¹¶ä¸”ä½¿ç”¨YOLOXçš„æ•°æ®å¢å¼ºç­–ç•¥ï¼Œåœ¨å‰é¢çš„éƒ¨åˆ†ä½¿ç”¨æ•°æ®å¢å¼ºï¼Œè€Œåœ¨æœ€åçš„10ä¸ªepochä¸­å…³é—­æ•°æ®å¢å¼ºã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![head](https://i-blog.csdnimg.cn/blog_migrate/71f91ae058e6ff1f18192733903f40b6.png)

å¯¹äºä¸€äº›å¸¸è§çš„æ•°æ®å¢å¼ºçš„æ–¹å¼çš„è¯´æ˜ã€‚

![image-20240817002209214](https://i-blog.csdnimg.cn/blog_migrate/981cb3b7c53cf508ccde5009a7e2b269.png)

#### è®­ç»ƒç­–ç•¥è¯´æ˜

YOLOv8 çš„æ¨ç†è¿‡ç¨‹å’Œ YOLOv5 å‡ ä¹ä¸€æ ·ï¼Œå”¯ä¸€å·®åˆ«åœ¨äºå‰é¢éœ€è¦å¯¹ Distribution Focal Loss ä¸­çš„ç§¯åˆ†è¡¨ç¤º bbox å½¢å¼è¿›è¡Œè§£ç ï¼Œå˜æˆå¸¸è§„çš„ 4 ç»´åº¦ bboxï¼Œåç»­è®¡ç®—è¿‡ç¨‹å°±å’Œ YOLOv5 ä¸€æ ·äº†ã€‚

ä»¥ COCO 80 ç±»ä¸ºä¾‹ï¼Œå‡è®¾è¾“å…¥å›¾ç‰‡å¤§å°ä¸º 640x640ï¼ŒMMYOLO ä¸­å®ç°çš„æ¨ç†è¿‡ç¨‹ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š

å…¶æ¨ç†å’Œåå¤„ç†è¿‡ç¨‹ä¸ºï¼š

![head](https://i-blog.csdnimg.cn/blog_migrate/1fd11a215281a4e1c2bb19709db7b2b8.png)

**(1) bbox ç§¯åˆ†å½¢å¼è½¬æ¢ä¸º 4d bbox æ ¼å¼**

å¯¹ Head è¾“å‡ºçš„ bbox åˆ†æ”¯è¿›è¡Œè½¬æ¢ï¼Œåˆ©ç”¨ Softmax å’Œ Conv è®¡ç®—å°†ç§¯åˆ†å½¢å¼è½¬æ¢ä¸º 4 ç»´ bbox æ ¼å¼

**(2) ç»´åº¦å˜æ¢**

YOLOv8 è¾“å‡ºç‰¹å¾å›¾å°ºåº¦ä¸º `80x80`ã€`40x40` å’Œ `20x20` çš„ä¸‰ä¸ªç‰¹å¾å›¾ã€‚Head éƒ¨åˆ†è¾“å‡ºåˆ†ç±»å’Œå›å½’å…± 6 ä¸ªå°ºåº¦çš„ç‰¹å¾å›¾ã€‚ å°† 3 ä¸ªä¸åŒå°ºåº¦çš„ç±»åˆ«é¢„æµ‹åˆ†æ”¯ã€bbox é¢„æµ‹åˆ†æ”¯è¿›è¡Œæ‹¼æ¥ï¼Œå¹¶è¿›è¡Œç»´åº¦å˜æ¢ã€‚ä¸ºäº†åç»­æ–¹ä¾¿å¤„ç†ï¼Œä¼šå°†åŸå…ˆçš„é€šé“ç»´åº¦ç½®æ¢åˆ°æœ€åï¼Œç±»åˆ«é¢„æµ‹åˆ†æ”¯ å’Œ bbox é¢„æµ‹åˆ†æ”¯ shape åˆ†åˆ«ä¸º (b, 80x80+40x40+20x20, 80)=(b,8400,80)ï¼Œ(b,8400,4)ã€‚

**(3) è§£ç è¿˜åŸåˆ°åŸå›¾å°ºåº¦**

åˆ†ç±»é¢„æµ‹åˆ†æ”¯è¿›è¡Œ Sigmoid è®¡ç®—ï¼Œè€Œ bbox é¢„æµ‹åˆ†æ”¯éœ€è¦è¿›è¡Œè§£ç ï¼Œè¿˜åŸä¸ºçœŸå®çš„åŸå›¾è§£ç å xyxy æ ¼å¼ã€‚

**(4) é˜ˆå€¼è¿‡æ»¤**

éå† batch ä¸­çš„æ¯å¼ å›¾ï¼Œé‡‡ç”¨ `score_thr` è¿›è¡Œé˜ˆå€¼è¿‡æ»¤ã€‚åœ¨è¿™è¿‡ç¨‹ä¸­è¿˜éœ€è¦è€ƒè™‘ **multi_label å’Œ nms_preï¼Œç¡®ä¿è¿‡æ»¤åçš„æ£€æµ‹æ¡†æ•°ç›®ä¸ä¼šå¤šäº nms_preã€‚**

**(5) è¿˜åŸåˆ°åŸå›¾å°ºåº¦å’Œ nms**

åŸºäºå‰å¤„ç†è¿‡ç¨‹ï¼Œå°†å‰©ä¸‹çš„æ£€æµ‹æ¡†è¿˜åŸåˆ°ç½‘ç»œè¾“å‡ºå‰çš„åŸå›¾å°ºåº¦ï¼Œç„¶åè¿›è¡Œ nms å³å¯ã€‚æœ€ç»ˆè¾“å‡ºçš„æ£€æµ‹æ¡†ä¸èƒ½å¤šäº **max_per_imgã€‚**

æœ‰ä¸€ä¸ªç‰¹åˆ«æ³¨æ„çš„ç‚¹ï¼š **YOLOv5 ä¸­é‡‡ç”¨çš„ Batch shape æ¨ç†ç­–ç•¥ï¼Œåœ¨ YOLOv8 æ¨ç†ä¸­æš‚æ—¶æ²¡æœ‰å¼€å¯ï¼Œä¸æ¸…æ¥šåé¢æ˜¯å¦ä¼šå¼€å¯ï¼Œåœ¨ MMYOLO ä¸­å¿«é€Ÿæµ‹è¯•äº†ä¸‹ï¼Œå¦‚æœå¼€å¯ Batch shape ä¼šæ¶¨å¤§æ¦‚ 0.1~0.2ã€‚**

### ä»£ç è§£æ

ä¸‹è½½ä»£ç ä¹‹åï¼Œä½ å°†ä¼šçœ‹åˆ°ä¸‹é¢çš„ä»£ç ç›®å½•ç»“æ„ï¼Œå…¶ä¸­`42_demo`æ˜¯æˆ‘å‡†å¤‡çš„ç®€æ˜“çš„æ‰§è¡Œæ–‡ä»¶ï¼Œå…¶ä½™æ–‡ä»¶éƒ½æ˜¯å®˜æ–¹çš„æ–‡ä»¶å’Œç›®å½•ï¼Œæ¯ä¸ªæ–‡ä»¶å¤§æ¦‚çš„ä½œç”¨å¦‚ä¸‹ã€‚

![image-20240818114837691](https://i-blog.csdnimg.cn/blog_migrate/82561248499db54edbe759fb94926517.png)

  * 42_demo/

è¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶æ˜¯ç”¨äºæˆ‘ä»¬æœ¬æ¬¡æ•™ç¨‹çš„è„šæœ¬ï¼Œæˆ‘ä»¬å°†è®­ç»ƒã€æµ‹è¯•ã€é¢„æµ‹ç­‰è„šæœ¬è¿›è¡Œäº†å•ç‹¬çš„å°è£…ï¼Œæ–¹ä¾¿åˆå­¦è€…æˆ–è€…ä¸æ˜¯è®¡ç®—æœºä¸“ä¸šçš„åŒå­¦è¿è¡Œï¼Œæ¯ä¸ªè„šæœ¬å¯¹åº”çš„å«ä¹‰å¦‚ä¸‹ã€‚

![image-20240818121142997](https://i-blog.csdnimg.cn/blog_migrate/385ef38fa03a5309f427299e9a850951.png)

å…¶ä¸­æ¯”è¾ƒé‡è¦çš„æ˜¯è®­ç»ƒçš„è„šæœ¬`start_train.py`ï¼Œè¿™ä¸ªè„šæœ¬è®°å½•äº†æ•°æ®çš„åŠ è½½å’Œä¸€äº›è®­ç»ƒçš„è¶…å‚æ•°ï¼Œå†…å®¹å¦‚ä¸‹ã€‚
    
        import time
    from ultralytics import YOLO
    
    # yolov8næ¨¡å‹è®­ç»ƒï¼šè®­ç»ƒæ¨¡å‹çš„æ•°æ®ä¸º'A_my_data.yaml'ï¼Œè½®æ•°ä¸º100ï¼Œå›¾ç‰‡å¤§å°ä¸º640ï¼Œè®¾å¤‡ä¸ºæœ¬åœ°çš„GPUæ˜¾å¡ï¼Œå…³é—­å¤šçº¿ç¨‹çš„åŠ è½½ï¼Œå›¾åƒåŠ è½½çš„æ‰¹æ¬¡å¤§å°ä¸º4ï¼Œå¼€å¯å›¾ç‰‡ç¼“å­˜
    model = YOLO('yolov8n.pt')  # load a pretrained model (recommended for training)
    results = model.train(data='A_my_data.yaml', epochs=100, imgsz=640, device=[0,], workers=0, batch=4, cache=True)  # å¼€å§‹è®­ç»ƒ
    time.sleep(10) # ç¡çœ 10sï¼Œä¸»è¦æ˜¯ç”¨äºæœåŠ¡å™¨å¤šæ¬¡è®­ç»ƒçš„è¿‡ç¨‹ä¸­ä½¿ç”¨


â€‹    
â€‹    

é¢„æµ‹çš„æµ‹è¯•è„šæœ¬ä¸»è¦ç”¨äºå•å¼ å›¾åƒçš„æ£€æµ‹ï¼Œè„šæœ¬ä¸º`start_single_detect.py`
    
        from ultralytics import YOLO
    
    # Load a model
    model = YOLO("yolov8n.pt")  # pretrained YOLOv8n model
    
    # Run batched inference on a list of images
    results = model(["images/resources/demo.jpg", ])  # return a list of Results objects
    
    # Process results list
    for result in results:
        boxes = result.boxes  # Boxes object for bounding box outputs
        masks = result.masks  # Masks object for segmentation masks outputs
        keypoints = result.keypoints  # Keypoints object for pose outputs
        probs = result.probs  # Probs object for classification outputs
        obb = result.obb  # Oriented boxes object for OBB outputs
        result.show()  # display to screen
        result.save(filename="images/resources/result.jpg")  # save to disk


â€‹    

  * docker/

Docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼Œå®ƒå…è®¸å¼€å‘è€…æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªå¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ Linux æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®ç°è™šæ‹ŸåŒ–ã€‚å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šæœ‰ä»»ä½•æ¥å£ã€‚

ç®€å•æ¥è¯´ï¼ŒDocker æä¾›äº†ä¸€ä¸ªå¯ä»¥è¿è¡Œä½ çš„åº”ç”¨ç¨‹åºçš„è™šæ‹Ÿç¯å¢ƒï¼Œä½†å®ƒæ¯”ä¼ ç»Ÿçš„è™šæ‹Ÿæœºæ›´åŠ è½»é‡å’Œå¿«é€Ÿã€‚ä½¿ç”¨ Dockerï¼Œä½ å¯ä»¥è½»æ¾åœ°åœ¨ä¸åŒçš„æœºå™¨å’Œå¹³å°ä¸Šéƒ¨ç½²ã€è¿è¡Œå’Œç®¡ç†åº”ç”¨ç¨‹åºï¼Œè€Œæ— éœ€æ‹…å¿ƒç¯å¢ƒé…ç½®å’Œä¾èµ–é—®é¢˜ã€‚

è¿™ä¸ªç›®å½•æ˜¯æ ¹æ®ç”¨æˆ·ä¸åŒçš„è½¯ç¡¬ä»¶æƒ…å†µå†™çš„é…ç½®æ–‡ä»¶ï¼Œä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹å¤§å®¶ä½¿ç”¨çš„ä¸æ˜¯å¾ˆå¤šï¼Œå¯¹äºçœ‹æˆ‘å†…å®¹çš„å°ä¼™ä¼´æ¥è¯´ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯å­¦ç”Ÿï¼Œä½¿ç”¨çš„æ›´å°‘ï¼Œæ‰€ä»¥è¿™é‡Œçš„å†…å®¹æˆ‘ä»¬å°±ä¸è¯¦ç»†è¯´æ˜äº†ã€‚

![image-20240818123305515](https://i-blog.csdnimg.cn/blog_migrate/cf8914a053eba04b31806bc36af1c3b7.png)

  * docs/

è¿™ä¸ªç›®å½•ç”¨äºæ”¾ç½®å¯¹è¿™ä¸ªä»£ç è§£é‡Šçš„å®˜æ–¹æ–‡æ¡£ï¼ŒåŒ…å«äº†å„ä¸ªä¸åŒçš„è¯­è¨€ã€‚

![image-20240818123410826](https://i-blog.csdnimg.cn/blog_migrate/40302a18f405f94a05fbe16af0caaee1.png)

  * examples/

è¿™ä¸ªç›®å½•ä¸‹æœ‰å®˜æ–¹æä¾›çš„ä¸€äº›æ¡ˆä¾‹ï¼Œå¹¶ä¸”åŒ…å«äº†ä¸€äº›æ¨¡å‹å¯¼å‡ºä¹‹åC++çš„è°ƒç”¨è„šæœ¬ï¼Œè¿™é‡Œçš„è„šæœ¬å¤§å¤šæ•°æ—¶å€™åªæœ‰åœ¨å®é™…éƒ¨ç½²çš„æ—¶å€™æ‰ä¼šä½¿ç”¨åˆ°ï¼Œå…³äºç¡¬ä»¶éƒ¨ç½²æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„å†…å®¹ï¼Œè¿™å—çš„å†…å®¹æˆ‘ä»¬ä¼šå•ç‹¬æŠ½æ—¶é—´æ¥è®²ã€‚

![image-20240818123441605](https://i-blog.csdnimg.cn/blog_migrate/a146ce25e507e6945d648d9b8e0c4712.png)

  * test/

testç›®å½•å­˜æ”¾äº†ä¸€äº›è‡ªåŠ¨åŒ–æµ‹è¯•çš„è„šæœ¬ã€‚

  * ultralytics/

è¯¥ç›®å½•æ˜¯æ•´ä¸ªé¡¹ç›®çš„æ ¸å¿ƒç›®å½•ï¼Œå­˜æ”¾äº†ç½‘ç»œç»“æ„çš„åº•å±‚å®ç°å’Œç½‘ç»œã€æ•°æ®é›†ä¸€ç³»åˆ—çš„é…ç½®æ–‡ä»¶ï¼Œå¹³å¸¸ä¿®æ”¹ç½‘ç»œç»“æ„å’Œæ–°å¢æ•°æ®éƒ½ä¼šåœ¨è¿™ä¸ªç›®å½•ä¸‹æ‰§è¡Œã€‚

assetsç›®å½•ä¸‹å­˜æ”¾äº†ä¸¤å¼ ç»å…¸çš„æµ‹è¯•å›¾åƒï¼Œç”¨äºæ¨¡å‹çš„åˆæ­¥éªŒè¯ã€‚

cfgç›®å½•ä¸‹å­˜æ”¾äº†æ•°æ®ã€æ¨¡å‹å’Œè¿½è¸ªçš„é…ç½®æ–‡ä»¶ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå…¶ä¸­datasetsä¸‹é¢çš„A_my_data.yamlå°±æ˜¯æˆ‘ä»¬æœ¬æ¬¡æ•™ç¨‹ä½¿ç”¨çš„æ•°æ®é›†é…ç½®æ–‡ä»¶ï¼Œåœ¨è¿™ä¸ªè·¯å¾„ä¸­æˆ‘ä»¬æŒ‡æ˜äº†æ•°æ®é›†çš„è·¯å¾„å’Œç±»åˆ«ç­‰ä¿¡æ¯ã€‚è€Œmodelsç›®å½•ä¸‹çš„yolov8.yamlé…ç½®æ–‡ä»¶åˆ™æŒ‡å®šäº†æˆ‘ä»¬è¦ä½¿ç”¨åˆ°çš„æ¨¡å‹ã€‚è¯¦ç»†çš„å†…å®¹å¦‚ä¸‹ï¼š

A_my_data.yaml
    
        # Train/val/test sets as 1) dir: path/to/imgs, 2) file: path/to/imgs.txt, or 3) list: [path/to/imgs1, path/to/imgs2, ..]
    path: ../../person_42_yolo_format
    train: # train images (relative to 'path')  16551 images
      - images/train
    val: # val images (relative to 'path')  4952 images
      - images/val
    test: # test images (optional)
      - images/test
    
    # Classes
    # ['Chave', 'DISJUNTOR', 'TP', 'Pararraio', 'TC']
    names:
    : person


â€‹    

yolov8.yaml
    
        # Ultralytics YOLO ğŸš€, AGPL-3.0 license
    # YOLOv8 object detection model with P3-P5 outputs. For Usage examples see https://docs.ultralytics.com/tasks/detect
    
    # Parameters
    nc: 80 # number of classes
    scales: # model compound scaling constants, i.e. 'model=yolov8n.yaml' will call yolov8.yaml with scale 'n'
      # [depth, width, max_channels]
      n: [0.33, 0.25, 1024] # YOLOv8n summary: 225 layers,  3157200 parameters,  3157184 gradients,   8.9 GFLOPs
      s: [0.33, 0.50, 1024] # YOLOv8s summary: 225 layers, 11166560 parameters, 11166544 gradients,  28.8 GFLOPs
      m: [0.67, 0.75, 768] # YOLOv8m summary: 295 layers, 25902640 parameters, 25902624 gradients,  79.3 GFLOPs
      l: [1.00, 1.00, 512] # YOLOv8l summary: 365 layers, 43691520 parameters, 43691504 gradients, 165.7 GFLOPs
      x: [1.00, 1.25, 512] # YOLOv8x summary: 365 layers, 68229648 parameters, 68229632 gradients, 258.5 GFLOPs
    
    # YOLOv8.0n backbone
    backbone:
      # [from, repeats, module, args]
      - [-1, 1, Conv, [64, 3, 2]] # 0-P1/2
      - [-1, 1, Conv, [128, 3, 2]] # 1-P2/4
      - [-1, 3, C2f, [128, True]]
      - [-1, 1, Conv, [256, 3, 2]] # 3-P3/8
      - [-1, 6, C2f, [256, True]]
      - [-1, 1, Conv, [512, 3, 2]] # 5-P4/16
      - [-1, 6, C2f, [512, True]]
      - [-1, 1, Conv, [1024, 3, 2]] # 7-P5/32
      - [-1, 3, C2f, [1024, True]]
      - [-1, 1, SPPF, [1024, 5]] # 9
    
    # YOLOv8.0n head
    head:
      - [-1, 1, nn.Upsample, [None, 2, "nearest"]]
      - [[-1, 6], 1, Concat, [1]] # cat backbone P4
      - [-1, 3, C2f, [512]] # 12
    
      - [-1, 1, nn.Upsample, [None, 2, "nearest"]]
      - [[-1, 4], 1, Concat, [1]] # cat backbone P3
      - [-1, 3, C2f, [256]] # 15 (P3/8-small)
    
      - [-1, 1, Conv, [256, 3, 2]]
      - [[-1, 12], 1, Concat, [1]] # cat head P4
      - [-1, 3, C2f, [512]] # 18 (P4/16-medium)
    
      - [-1, 1, Conv, [512, 3, 2]]
      - [[-1, 9], 1, Concat, [1]] # cat head P5
      - [-1, 3, C2f, [1024]] # 21 (P5/32-large)
    
      - [[15, 18, 21], 1, Detect, [nc]] # Detect(P3, P4, P5)


â€‹    

åé¢çš„`data`ã€`engine`ã€`hub`ã€`models`ã€`nn`ã€`solution`ã€`trackers`ã€`utils`åˆ™åˆ†åˆ«å®šä¹‰äº†æ•°æ®ã€æ¨¡å‹è®­ç»ƒå¼•æ“ã€è®­ç»ƒå¯è§†åŒ–ã€æ¨¡å‹ã€ç½‘ç»œç»“æ„ã€è§£å†³æ–¹æ¡ˆã€è¿½è¸ªå’Œå·¥å…·ç±»çš„åº•å±‚ä»£ç å®ç°ã€‚æ¯”å¦‚åœ¨nnç›®å½•ä¸‹çš„modelsç›®å½•ä¸‹çš„block.pyä¸­å°±ç»™å‡ºäº†c2fæ¨¡å—çš„å®šä¹‰ã€‚
    
        class C2f(nn.Module):
        """
        è¿™é‡Œä½¿ç”¨äº†åˆ†æ”¯å¤„ç†çš„æ“ä½œï¼Œä½¿ç”¨çš„æ˜¯é€šè¿‡å…³é—­æ®‹å·®é“¾æ¥çš„æ–¹å¼å®ç°
        å…ˆè¿›è¡Œåˆ†æ”¯çš„æ“ä½œç„¶åå†è¿›è¡Œç‰¹å¾èåˆçš„æ“ä½œ
        Faster Implementation of CSP Bottleneck with 2 convolutions.
        """
    
        def __init__(self, c1, c2, n=1, shortcut=False, g=1, e=0.5):
            """Initialize CSP bottleneck layer with two convolutions with arguments ch_in, ch_out, number, shortcut, groups,
            expansion.
            """
            super().__init__()
            self.c = int(c2 * e)  # hidden channels
            self.cv1 = Conv(c1, 2 * self.c, 1, 1)
            self.cv2 = Conv((2 + n) * self.c, c2, 1)  # optional act=FReLU(c2)
            self.m = nn.ModuleList(Bottleneck(self.c, self.c, shortcut, g, k=((3, 3), (3, 3)), e=1.0) for _ in range(n))
    
        def forward(self, x):
            """Forward pass through C2f layer."""
            y = list(self.cv1(x).chunk(2, 1))
            y.extend(m(y[-1]) for m in self.m)
            return self.cv2(torch.cat(y, 1))
    
        def forward_split(self, x):
            """Forward pass using split() instead of chunk()."""
            y = list(self.cv1(x).split((self.c, self.c), 1))
            y.extend(m(y[-1]) for m in self.m)
            return self.cv2(torch.cat(y, 1))


â€‹    

  * ultralytics.egg-info/

**egg-infoæ˜¯ä¸€ä¸ªç›®å½•** ï¼Œå®ƒåœ¨å®‰è£…æˆ–å¼€å‘PythonåŒ…æ—¶ç”±setuptoolsç”Ÿæˆï¼Œç”¨äºå­˜å‚¨å…³äºè¯¥åŒ…çš„å…ƒæ•°æ®ã€‚è¿™äº›å…ƒæ•°æ®å¯¹äºåŒ…çš„ç®¡ç†ã€åˆ†å‘å’Œå®‰è£…è‡³å…³é‡è¦ï¼Œå®ƒä»¬å¸®åŠ©pipå’Œå…¶ä»–å·¥å…·äº†è§£åŒ…çš„è¯¦ç»†ä¿¡æ¯ã€ç‰ˆæœ¬ä¿¡æ¯ã€ä¾èµ–å…³ç³»ç­‰ã€‚è¿™ä¸ªç›®å½•æ˜¯æˆ‘ä»¬æ‰§è¡ŒpipæŒ‡ä»¤ä»¥å¼€å‘è€…æ¨¡å¼å®‰è£…çš„æ—¶å€™å‡ºç°çš„ã€‚

  * CITATION.cff

è¿™ä¸ªæ–‡ä»¶ä¸­åŒ…å«äº†å¼•ç”¨è¿™ä¸ªé¡¹ç›®çš„æ ¼å¼è¯´æ˜ã€‚

  * CONTRIBUTING.md

è¿™ä¸ªé‡Œé¢è¯´æ˜äº†ä½ å¯ä»¥å¦‚ä½•ä¸ºè¿™ä¸ªé¡¹ç›®æä¾›è‡ªå·±çš„è´¡çŒ®ï¼Œè®©è‡ªå·±çš„åå­—å‡ºç°åœ¨ä½œè€…åå•ä¸­ã€‚

  * LICENSE

æä¾›äº†è¿™è¯¥é¡¹ç›®çš„è®¸å¯ä¿¡æ¯ã€‚

  * mkdocs.yml

ç”¨äºå®šä¹‰é¡¹ç›®çš„å„ç§è®¾ç½®å’Œé…ç½®é€‰é¡¹ã€‚

  * pyproject.toml

`pyproject.toml` æ˜¯ä¸€ä¸ªåœ¨ Python é¡¹ç›®ä¸­å¹¿æ³›ä½¿ç”¨çš„é…ç½®æ–‡ä»¶ï¼Œå®ƒä¸»è¦ç”¨äºå®šä¹‰é¡¹ç›®çš„æ„å»ºç³»ç»Ÿè¦æ±‚ã€ä¾èµ–å…³ç³»ä»¥åŠç›¸å…³çš„å·¥å…·é…ç½®ã€‚ç°åœ¨è¿™ä¸ª pyproject.toml ä¹Ÿæ˜¯å®˜æ–¹ä»PEP 518å¼€å§‹æ¨èçš„é¡¹ç›®é…ç½®æ–¹å¼ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥å»çœ‹ä¸€ä¸‹poetryè¿™ä¸ªåº“ï¼Œé€šè¿‡poetry newå¯ä»¥å¾ˆæ–¹ä¾¿å¿«æ·çš„ç”Ÿæˆä¸€ä¸ªé¡¹ç›®çš„è„šæ‰‹æ¶ä»£ç ã€‚

  * README.md

è¯´æ˜æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ä½ ç°åœ¨çœ‹åˆ°çš„è¿™ä¸ªå†…å®¹ã€‚

  * README.zh-CN.md

ä¸­æ–‡æ ¼å¼çš„è¯´æ˜æ–‡ä»¶ã€‚

### æ•°æ®é›†å‡†å¤‡

æˆ‘ä»¬åœ¨è¿™é‡Œå‡†å¤‡äº†ä¸€ç³»åˆ—æ ‡æ³¨å¥½çš„æ•°æ®é›†ï¼Œå¦‚æœå¤§å®¶ä¸æƒ³è‡ªå·±æ ‡æ³¨å¯ä»¥çœ‹çœ‹è¿™é‡Œæ˜¯å¦æœ‰ä½ éœ€è¦å¾—ï¼š[è‚†åäºŒå¤§ä½œä¸šç³»åˆ—æ¸…å•-CSDNåšå®¢](https://blog.csdn.net/ECHOSON/article/details/141068765)  
ç°åœ¨æ¥åˆ°æˆ‘ä»¬æ•°æ®é›†å‡†å¤‡çš„ç« èŠ‚ï¼Œè¿™ä¸ªç« èŠ‚æ•™ä¼šå¤§å®¶å¦‚ä½•è‡ªå·±æ„å»ºä¸€ä¸ªyoloçš„æ£€æµ‹æ•°æ®ä»¥åŠå¦‚ä½•ä½¿ç”¨ã€‚

é¦–å…ˆè¿™ä¸ªä½ç½®æä¾›äº†æˆ‘ä»¬æœ¬æ¬¡æ•™ç¨‹ä¸­ä½¿ç”¨åˆ°çš„ä¸€ä»½æ ‡å‡†çš„è¡Œäººæ£€æµ‹çš„æ•°æ®é›†ï¼Œä¸€ä¸ªæ ‡å‡†çš„æ•°æ®é›†çš„æ„æˆåŒ…å«ä¸‹é¢çš„å‡ ä¸ªç›®å½•ã€‚
    
    
    â”œâ”€images    # å›¾åƒæ–‡ä»¶å¤¹
    â”‚  â”œâ”€train  # è®­ç»ƒé›†å›¾åƒ
    â”‚  â”œâ”€val    # éªŒè¯é›†å›¾åƒ
    â”‚  â””â”€test   # æµ‹è¯•é›†å›¾åƒ
    â””â”€labels    # æ ‡ç­¾æ–‡ä»¶å¤¹ï¼Œæ ‡ç­¾æ ¼å¼ä¸ºyoloçš„txtæ ¼å¼
        â”œâ”€train # è®­ç»ƒé›†æ ‡ç­¾
        â”œâ”€val   # éªŒè¯é›†æ ‡ç­¾
        â””â”€test  # æµ‹è¯•é›†æ ‡ç­¾


ä»¥è®­ç»ƒé›†ä¸ºä¾‹ï¼Œç»™å°ä¼™ä¼´ä»¬å±•ç¤ºä¸€ä¸‹ä¸€ä¸ªæ­£ç¡®çš„å¯¹åº”å…³ç³»æ˜¯æ€æ ·çš„ï¼Œè¿™é‡Œè®­ç»ƒé›†å›¾åƒæ•°é‡å’Œæ ‡ç­¾æ•°é‡æ˜¯ä¸€è‡´çš„ï¼Œå¹¶ä¸”åç§°ä¸Šé¢å»é™¤åç¼€ä¹‹åæ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚

![image-20240818134219994](https://i-blog.csdnimg.cn/blog_migrate/93fe61cf5d00a36346925125c46cf11b.png)

ä»¥2007_000480.jpgä¸ºä¾‹ï¼Œä¸‹é¢æ˜¯å¯¹åº”çš„2007_000480.txtä¸­çš„æ ‡æ³¨æ–‡ä»¶å†…å®¹ã€‚è¿™ä¸ªæ ‡æ³¨æ–‡ä»¶æœ‰ä¸‰è¡Œï¼Œå¯¹åº”çš„æ˜¯å›¾åƒä¸­çš„3ä¸ªäººç‰©ï¼Œå…¶ä¸­æ¯è¡ŒåŒ…å«5ä¸ªæ•°å­—ï¼Œåˆ†åˆ«æ˜¯ç±»åˆ«ï¼Œå½’ä¸€åŒ–å¤„ç†ä¹‹åç›®æ ‡ä¸­å¿ƒç‚¹çš„xåæ ‡ã€yåæ ‡ã€ç›®æ ‡å½’ä¸€åŒ–å¤„ç†ä¹‹åå®½åº¦wå’Œç›®æ ‡å½’ä¸€åŒ–å¤„ç†ä¹‹åçš„å®½åº¦hã€‚

![image-20240818134331149](https://i-blog.csdnimg.cn/blog_migrate/a72c28c7524f2f77441172c68bb09ed4.png)

å¦‚æœå¤§å®¶è¦æ ‡æ³¨è‡ªå·±çš„æ•°æ®é›†ï¼Œåˆ™å¯ä»¥ä½¿ç”¨labelimgæ¥è¿›è¡Œæ ‡æ³¨ï¼Œæ ‡æ³¨ä¹‹å‰æœ‰å‡ ç‚¹æ³¨æ„äº‹é¡¹ã€‚

  * æ ‡æ³¨çš„å›¾åƒå’Œè·¯å¾„å°½é‡ä¸è¦åŒ…å«ä¸­æ–‡ï¼Œå›¾åƒåç§°æœ€å¥½æ˜¯åªæœ‰æ•°å­—æˆ–è€…è‹±æ–‡ã€‚
  * æ ‡æ³¨çš„æ—¶å€™å°½é‡ä½¿ç”¨jpgçš„æ ¼å¼ï¼Œå¦‚æœæ˜¯gifä¸€ç±»çš„æ ¼å¼åç»­å¯èƒ½æœ‰å…¶ä»–çš„éº»çƒ¦ã€‚
  * æ ‡æ³¨çš„æ—¶å€™è¯·ä¸€å®šè¦ç¡®ä¿é€‰æ‹©äº†yoloæ ¼å¼ï¼Œå¦‚æœä¸æ˜¯yoloæ ¼å¼åç»­å¤„ç†èµ·æ¥ä¼šéå¸¸éº»çƒ¦ã€‚
  * æœ€å¥½ä¸€æ¬¡æ€§æ ‡æ³¨å®Œï¼Œè´Ÿè´£å¯èƒ½å¯¼è‡´å‰åä¸¤æ¬¡æ ‡ç­¾çš„ç»“æœä¸ä¸€è‡´ã€‚

okï¼Œé¦–å…ˆå¤§å®¶å¯ä»¥åœ¨ä½ çš„è™šæ‹Ÿç¯å¢ƒä¸­é€šè¿‡`pip install labelimg`çš„æŒ‡ä»¤å®‰è£…æ ‡æ³¨ç„¶åï¼Œç„¶ååœ¨å‘½ä»¤è¡Œä¸­é”®å…¥labelimgæ¥å¯åŠ¨æ ‡æ³¨è½¯ä»¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![image-20240818134903915](https://i-blog.csdnimg.cn/blog_migrate/93b08d365d57f6a62639b4d24e0a549b.png)

![image-20240818134948284](https://i-blog.csdnimg.cn/blog_migrate/10df05d13fc5a87ecd4c75b9b757e52e.png)

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ‰“å¼€è¦æ ‡æ³¨çš„æ–‡ä»¶å¤¹å°±å¯ä»¥è¿›è¡Œæ ‡æ³¨äº†ï¼Œæ ‡æ³¨ä¹‹åä¸€å®šè¦æ£€æŸ¥æ˜¯å¦æ ‡æ³¨æ–‡ä»¶ä¸ºtxtæ ¼å¼ã€‚

![image-20240818141821358](https://i-blog.csdnimg.cn/blog_migrate/355d75c92d6974f1e611499aaf735bf8.png)

ä¸‹é¢æ˜¯labelimgçš„å¸¸ç”¨çš„å¿«æ·æ–¹å¼ï¼Œå¤§å®¶å¯ä»¥ç†Ÿæ‚‰ä¸‹é¢çš„å¿«æ·æ–¹å¼å¸®åŠ©ä½ æå‡æ ‡æ³¨çš„æ•ˆç‡ã€‚

ctrl+s| ä¿å­˜  
---|---  
ctrl+d| å¤åˆ¶å½“å‰æ ‡ç­¾å’ŒçŸ©å½¢æ¡†  
Ctrl + r| æ›´æ”¹é»˜è®¤æ³¨é‡Šç›®å½•ï¼ˆxmlæ–‡ä»¶ä¿å­˜çš„åœ°å€ï¼‰  
Ctrl + u| åŠ è½½ç›®å½•ä¸­çš„æ‰€æœ‰å›¾åƒï¼Œé¼ æ ‡ç‚¹å‡»Open diråŒåŠŸèƒ½  
w| åˆ›å»ºçŸ©é˜µ  
d| ä¸‹ä¸€å¼   
a| ä¸Šä¸€å¼   
delete| åˆ é™¤é€‰å®šçš„çŸ©é˜µæ¡†  
space| å°†å½“å‰å›¾åƒæ ‡è®°ä¸ºå·²æ ‡è®°  

### ç¯å¢ƒé…ç½®

æ¥åˆ°æˆ‘ä»¬æœ€ç†Ÿæ‚‰çš„ç« èŠ‚ï¼Œç¯å¢ƒé…ç½®ï¼Œè€ç”Ÿå¸¸è°ˆï¼Œç¯å¢ƒé…ç½®åŸºæœ¬æ˜¯ä¸€è‡´çš„ï¼Œå¼€å§‹å‰è¯·å…ˆå­¦ä¹ pycharmå’Œanacondaçš„ä½¿ç”¨ï¼Œä¸ç†Ÿæ‚‰çš„å°ä¼™ä¼´å¯ä»¥ç§»æ­¥è¿™ä¸ªä½ç½®ï¼š[ã€å¤§ä½œä¸šç³»åˆ—å…¥é—¨æ•™ç¨‹ã€‘å¦‚ä½•ä½¿ç”¨Anacondaå’ŒPycharm_2024æ¯•è®¾ç³»åˆ—å¦‚ä½•ä½¿ç”¨anaconda-CSDNåšå®¢](https://blog.csdn.net/ECHOSON/article/details/136097910)

ä¸‹è½½å®‰è£…åŒ…åˆ°æœ¬åœ°ï¼Œé¦–å…ˆè¯·æ‰§è¡Œä¸‹åˆ—æŒ‡ä»¤ç¡®ä¿ä½ å·²ç»é…ç½®å¥½äº†å›½å†…çš„æºã€‚
    
    
    conda config --remove-key channels
    conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/
    conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/
    conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/
    conda config --set show_channel_urls yes
    pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple


ä¹‹åè¯·å…ˆå®‰è£…pytorchï¼Œè¯·æ ¹æ®ä½ è®¾å¤‡çš„å®é™…æƒ…å†µæ¥é€‰æ‹©æ‰§è¡ŒGPUå®‰è£…çš„æŒ‡ä»¤æˆ–è€…æ˜¯CPUå®‰è£…çš„æŒ‡ä»¤ã€‚
    
    
    conda install pytorch==1.8.0 torchvision torchaudio cudatoolkit=10.2 # æ³¨æ„è¿™æ¡å‘½ä»¤æŒ‡å®šPytorchçš„ç‰ˆæœ¬å’Œcudaçš„ç‰ˆæœ¬
    conda install pytorch==1.10.0 torchvision torchaudio cudatoolkit=11.3 # 30ç³»åˆ—ä»¥ä¸Šæ˜¾å¡gpuç‰ˆæœ¬pytorchå®‰è£…æŒ‡ä»¤
    conda install pytorch==1.8.0 torchvision==0.9.0 torchaudio==0.8.0 cpuonly # CPUçš„å°ä¼™ä¼´ç›´æ¥æ‰§è¡Œè¿™æ¡å‘½ä»¤å³å¯


æ¥ç€æ¥åˆ°é¡¹ç›®çš„ç›®å½•ä¸‹ï¼Œä»¥å¼€å‘è€…çš„æ¨¡å¼å®‰è£…å…¶ä½™éœ€è¦çš„åº“ã€‚
    
    
    pip install -v -e .


![image-20240819003030009](https://i-blog.csdnimg.cn/blog_migrate/ed02ce78630be53acee0f7025f83d52f.png)

OKï¼Œæˆ‘ä»¬æ¥åšä¸€ä¸ªç®€å•çš„æµ‹è¯•ï¼Œè§‚çœ‹æ˜¯å¦ç”Ÿæ•ˆï¼Œå¦‚æœä½ çœ‹åˆ°äº†ä¸‹é¢çš„ç»“æœåˆ™è¯´æ˜ä½ çš„ç¯å¢ƒé…ç½®æ²¡æœ‰é—®é¢˜ã€‚

![image-20240819003145006](https://i-blog.csdnimg.cn/blog_migrate/45a63df58518338d3473095fd02be97d.png)

å¦‚æœæ²¡æœ‰å‡ºç°ä¸Šé¢çš„æ£€æµ‹ç»“æœï¼Œåˆ™è¯´æ˜ä½ çš„é…ç½®å‡ºç°äº†é—®é¢˜ï¼Œå¯ä»¥åœ¨è¯„è®ºåŒºä¸­ç•™è¨€ï¼Œè®©å°ä¼™ä¼´ä»¬ä¸€åŒç»™ä½ è§£ç­”ã€‚

### æ¨¡å‹è®­ç»ƒå’Œæµ‹è¯•

#### æ¨¡å‹çš„è®­ç»ƒ

è®­ç»ƒçš„è„šæœ¬å¯¹åº”çš„æ˜¯ï¼š
    
    
    import time
    from ultralytics import YOLO


â€‹    
    # yolov8næ¨¡å‹è®­ç»ƒï¼šè®­ç»ƒæ¨¡å‹çš„æ•°æ®ä¸º'A_my_data.yaml'ï¼Œè½®æ•°ä¸º100ï¼Œå›¾ç‰‡å¤§å°ä¸º640ï¼Œè®¾å¤‡ä¸ºæœ¬åœ°çš„GPUæ˜¾å¡ï¼Œå…³é—­å¤šçº¿ç¨‹çš„åŠ è½½ï¼Œå›¾åƒåŠ è½½çš„æ‰¹æ¬¡å¤§å°ä¸º4ï¼Œå¼€å¯å›¾ç‰‡ç¼“å­˜
    model = YOLO('yolov8n.pt')  # load a pretrained model (recommended for training)
    results = model.train(data='A_my_data.yaml', epochs=100, imgsz=640, device=[0,], workers=0, batch=4, cache=True)  # å¼€å§‹è®­ç»ƒ
    time.sleep(10) # ç¡çœ 10sï¼Œä¸»è¦æ˜¯ç”¨äºæœåŠ¡å™¨å¤šæ¬¡è®­ç»ƒçš„è¿‡ç¨‹ä¸­ä½¿ç”¨


â€‹    
â€‹    

å¼€å§‹ä¹‹å‰è¯·é…ç½®å¥½ä½ çš„æ•°æ®é›†çš„è·¯å¾„å’Œå›¾ç‰‡åç§°ï¼Œæ¯”å¦‚æˆ‘ä»¬ä»Šå¤©è®­ç»ƒçš„è¡Œäººæ£€æµ‹çš„æ•°æ®é›†çš„é…ç½®å¦‚ä¸‹ï¼š
    
    
    # Train/val/test sets as 1) dir: path/to/imgs, 2) file: path/to/imgs.txt, or 3) list: [path/to/imgs1, path/to/imgs2, ..]
    path: ../../person_42_yolo_format
    train: # train images (relative to 'path')  16551 images
      - images/train
    val: # val images (relative to 'path')  4952 images
      - images/val
    test: # test images (optional)
      - images/test
    
    # Classes
    # ['Chave', 'DISJUNTOR', 'TP', 'Pararraio', 'TC']
    names:
    : person


â€‹    

é…ç½®å¥½äº†ç›´æ¥å³é”®è¿è¡Œå³å¯ï¼Œæ¯”å¦‚æˆ‘ä»¬è¿™é‡Œæ˜¯è®­ç»ƒ100è½®ï¼Œè®­ç»ƒçš„è¿‡ç¨‹ä¸­è¿›åº¦æ¡ä¼šå®æ—¶è¿›è¡Œæ›´æ–°ã€‚

![image-20240818152211336](https://i-blog.csdnimg.cn/blog_migrate/2ddcaa2ec2aa44b87ff6747ca43aeea9.png)

è®­ç»ƒå®Œæ¯•ä¹‹åï¼Œå°†ä¼šåœ¨runsç›®å½•ä¸‹ç”Ÿæˆä¸€ç³»åˆ—çš„ç»“æœå›¾åƒã€‚

![image-20240818152553473](https://i-blog.csdnimg.cn/blog_migrate/06dc05de030b22efac4cfb1b0f1ba4fe.png)

å…¶ä¸­å¦‚æœä½ éœ€è¦åœ¨ä½ çš„æŠ¥å‘Šä¸­è¯´æ˜æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹å’Œè®­ç»ƒç»“æœï¼Œä½¿ç”¨æœ€å¤šçš„åˆ†åˆ«æ˜¯results.pngå’ŒPR_curve.pngï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![image-20240818152907734](https://i-blog.csdnimg.cn/blog_migrate/2376440b84d87c24da67e3caa63a0fd8.png)

![image-20240818152924610](https://i-blog.csdnimg.cn/blog_migrate/6fbd435ec1ea3880bdea1309d1508024.png)

#### æ¨¡å‹çš„æµ‹è¯•

æµ‹è¯•çš„è„šæœ¬å¯¹åº”çš„æ˜¯ï¼š
    
    
    from ultralytics import YOLO
    
    # åŠ è½½è‡ªå·±è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œå¡«å†™ç›¸å¯¹äºè¿™ä¸ªè„šæœ¬çš„ç›¸å¯¹è·¯å¾„æˆ–è€…å¡«å†™ç»å¯¹è·¯å¾„å‡å¯
    model = YOLO("runs/detect/yolov8n/weights/best.pt")
    
    # å¼€å§‹è¿›è¡ŒéªŒè¯ï¼ŒéªŒè¯çš„æ•°æ®é›†ä¸º'A_my_data.yaml'ï¼Œå›¾åƒå¤§å°ä¸º640ï¼Œæ‰¹æ¬¡å¤§å°ä¸º4ï¼Œç½®ä¿¡åº¦åˆ†æ•°ä¸º0.25ï¼Œäº¤å¹¶æ¯”çš„é˜ˆå€¼ä¸º0.6ï¼Œè®¾å¤‡ä¸º0ï¼Œå…³é—­å¤šçº¿ç¨‹ï¼ˆwindowsä¸‹ä½¿ç”¨å¤šçº¿ç¨‹åŠ è½½æ•°æ®å®¹æ˜“å‡ºç°é—®é¢˜ï¼‰
    validation_results = model.val(data='A_my_data.yaml', imgsz=640, batch=4, conf=0.25, iou=0.6, device="0", workers=0)


â€‹    

æ‰§è¡Œæµ‹è¯•çš„è„šæœ¬ï¼Œå°†ä¼šè¾“å‡ºä¸‹é¢çš„éªŒè¯æŒ‡æ ‡ã€‚

å¦‚æœä½ ä¸éœ€è¦å›¾å½¢åŒ–ç•Œé¢ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„è„šæœ¬æ¥ç›´æ¥å¯¹å›¾åƒè¿›è¡Œé¢„æµ‹ã€‚
    
    
    from ultralytics import YOLO
    
    # Load a model
    model = YOLO("yolov8n.pt")  # pretrained YOLOv8n model
    
    # Run batched inference on a list of images
    results = model(["images/resources/demo.jpg", ])  # return a list of Results objects
    
    # Process results list
    for result in results:
        boxes = result.boxes  # Boxes object for bounding box outputs
        masks = result.masks  # Masks object for segmentation masks outputs
        keypoints = result.keypoints  # Keypoints object for pose outputs
        probs = result.probs  # Probs object for classification outputs
        obb = result.obb  # Oriented boxes object for OBB outputs
        result.show()  # display to screen
        result.save(filename="images/resources/result.jpg")  # save to disk


â€‹    

![image-20240818151945707](https://i-blog.csdnimg.cn/blog_migrate/99a0cce258279c9470cb0763157654be.png)

### å›¾å½¢åŒ–ç•Œé¢å¼€å‘

å›¾å½¢åŒ–ç•Œé¢éƒ¨åˆ†çš„å¼€å‘ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†æ–°çš„PySide6/PyQt6ã€‚PyQtå’ŒPySideéƒ½æ˜¯C++çš„ç¨‹åºå¼€å‘æ¡†æ¶Qtçš„Pythonå®ç°ã€‚PyQtæ˜¯ç¬¬ä¸‰æ–¹ç»„ç»‡å¯¹Qtå®˜æ–¹æä¾›çš„Pythonå®ç°ï¼Œä¹Ÿæ˜¯Qt for Pythonæœ€ä¸»è¦çš„å®ç°ã€‚Qtå®˜æ–¹å¯¹Pythonçš„æ”¯æŒåŠ›åº¦è¶Šæ¥è¶Šå¤§ï¼Œç”±äºå„ç§åŸå› ï¼ŒQtçš„å®˜æ–¹é€‰æ‹©ä½¿ç”¨PySideæä¾›å¯¹Python Qtçš„æ”¯æŒã€‚æ‰€ä»¥ï¼ŒPython Qtå®é™…ä¸Šå­˜åœ¨ä¸¤ä¸ªåˆ†æ”¯ï¼šQt4å¯¹åº”PyQt4å’ŒPySideï¼›Qt5å¯¹åº”PyQt5å’ŒPySide2ï¼›Qt6åˆ™å¯¹åº”äº†PyQt6å’ŒPySide6ã€‚ç”±äºå®˜æ–¹æä¾›çš„PySide6ä»åŠŸèƒ½ä¸Šæ¥è¯´æ›´å¼ºï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯åˆ‡æ¢ä¸ºPySide6ä½œä¸ºæœ¬æ¬¡å›¾å½¢åŒ–ç•Œé¢å¼€å‘çš„æ¡†æ¶ã€‚ï¼ˆå®æµ‹ä¸‹æ¥ä»–ä»¬ç›´æ¥çš„åˆ‡æ¢å¯¹äºæˆ‘ä»¬è¿™äº›å¼€å‘äººå‘˜æ¥è¯´éå¸¸ä¸æ»‘ï¼Œæˆ‘æœ¬æ¬¡çš„æ›´æ–°ä¸­ä¹Ÿåªæ˜¯æ›´æ¢äº†ä¸€ä¸‹å¯¼å…¥çš„è¿‡ç¨‹ï¼‰

ä¸‹é¢æ˜¯æˆ‘ä»¬è¿™ä¸ªå›¾å½¢åŒ–ç•Œé¢ç¨‹åºçš„å®ç°ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬çš„å›¾å½¢åŒ–ç•Œé¢æ²¡æœ‰ä½¿ç”¨åˆ°designerçš„å›¾å½¢åŒ–å·¥å…·ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ä»£ç æ˜¯æ²¡æœ‰UIæ–‡ä»¶çš„ï¼Œå¦‚æœæœ‰å°ä¼™ä¼´å¯¹designeré‚£ç§å¯è§†åŒ–çš„å›¾å½¢åŒ–ç•Œé¢æ¯”è¾ƒæ„Ÿå…´è¶£ï¼Œå¯ä»¥å»å­¦ä¹ ä¸€ä¸‹é‚£ç§æ–¹å¼ï¼Œæ„å»ºå‡ºæ¥çš„å›¾å½¢åŒ–ç•Œé¢å¯èƒ½æ¯”è¾ƒç‚«ä¸€äº›ã€‚
    
    
    import copy                      # ç”¨äºå›¾åƒå¤åˆ¶
    import os                        # ç”¨äºç³»ç»Ÿè·¯å¾„æŸ¥æ‰¾
    import shutil                    # ç”¨äºå¤åˆ¶
    from PySide6.QtGui import *      # GUIç»„ä»¶
    from PySide6.QtCore import *     # å­—ä½“ã€è¾¹è·ç­‰ç³»ç»Ÿå˜é‡
    from PySide6.QtWidgets import *  # çª—å£ç­‰å°ç»„ä»¶
    import threading                 # å¤šçº¿ç¨‹
    import sys                       # ç³»ç»Ÿåº“
    import cv2                       # opencvå›¾åƒå¤„ç†
    import torch                     # æ·±åº¦å­¦ä¹ æ¡†æ¶
    import os.path as osp            # è·¯å¾„æŸ¥æ‰¾
    import time                      # æ—¶é—´è®¡ç®—
    from ultralytics import YOLO     # yoloæ ¸å¿ƒç®—æ³•
    
    # å¸¸ç”¨çš„å­—ç¬¦ä¸²å¸¸é‡
    WINDOW_TITLE ="Target detection system"
    WELCOME_SENTENCE = "æ¬¢è¿ä½¿ç”¨åŸºäºyolov8çš„è¡Œäººæ£€æµ‹ç³»ç»Ÿ"
    ICON_IMAGE = "images/UI/lufei.png"
    IMAGE_LEFT_INIT = "images/UI/up.jpeg"
    IMAGE_RIGHT_INIT = "images/UI/right.jpeg"


â€‹    
    class MainWindow(QTabWidget):
        def __init__(self):
            # åˆå§‹åŒ–ç•Œé¢
            super().__init__()
            self.setWindowTitle(WINDOW_TITLE)       # ç³»ç»Ÿç•Œé¢æ ‡é¢˜
            self.resize(1200, 800)           # ç³»ç»Ÿåˆå§‹åŒ–å¤§å°
            self.setWindowIcon(QIcon(ICON_IMAGE))   # ç³»ç»Ÿlogoå›¾åƒ
            self.output_size = 480                  # ä¸Šä¼ çš„å›¾åƒå’Œè§†é¢‘åœ¨ç³»ç»Ÿç•Œé¢ä¸Šæ˜¾ç¤ºçš„å¤§å°
            self.img2predict = ""                   # è¦è¿›è¡Œé¢„æµ‹çš„å›¾åƒè·¯å¾„
            # self.device = 'cpu'
            self.init_vid_id = '0'  # æ‘„åƒå¤´ä¿®æ”¹
            self.vid_source = int(self.init_vid_id)
            self.cap = cv2.VideoCapture(self.vid_source)
            self.stopEvent = threading.Event()
            self.webcam = True
            self.stopEvent.clear()
            self.model_path = "yolov8n.pt"  # todo æŒ‡æ˜æ¨¡å‹åŠ è½½çš„ä½ç½®çš„è®¾å¤‡
            self.model = self.model_load(weights=self.model_path)
            self.conf_thres = 0.25   # ç½®ä¿¡åº¦çš„é˜ˆå€¼
            self.iou_thres = 0.45    # NMSæ“ä½œçš„æ—¶å€™ IOUè¿‡æ»¤çš„é˜ˆå€¼
            self.vid_gap = 30        # æ‘„åƒå¤´è§†é¢‘å¸§ä¿å­˜é—´éš”ã€‚
            self.initUI()            # åˆå§‹åŒ–å›¾å½¢åŒ–ç•Œé¢
            self.reset_vid()         # é‡æ–°è®¾ç½®è§†é¢‘å‚æ•°ï¼Œé‡æ–°åˆå§‹åŒ–æ˜¯ä¸ºäº†é˜²æ­¢è§†é¢‘åŠ è½½å‡ºé”™
    
        # æ¨¡å‹åˆå§‹åŒ–
        @torch.no_grad()
        def model_load(self, weights=""):
            """
            æ¨¡å‹åŠ è½½
            """
            model_loaded = YOLO(weights)
            return model_loaded
    
        def initUI(self):
            """
            å›¾å½¢åŒ–ç•Œé¢åˆå§‹åŒ–
            """
            # ********************* å›¾ç‰‡è¯†åˆ«ç•Œé¢ *****************************
            font_title = QFont('æ¥·ä½“', 16)
            font_main = QFont('æ¥·ä½“', 14)
            img_detection_widget = QWidget()
            img_detection_layout = QVBoxLayout()
            img_detection_title = QLabel("å›¾ç‰‡è¯†åˆ«åŠŸèƒ½")
            img_detection_title.setFont(font_title)
            mid_img_widget = QWidget()
            mid_img_layout = QHBoxLayout()
            self.left_img = QLabel()
            self.right_img = QLabel()
            self.left_img.setPixmap(QPixmap(IMAGE_LEFT_INIT))
            self.right_img.setPixmap(QPixmap(IMAGE_RIGHT_INIT))
            self.left_img.setAlignment(Qt.AlignCenter)
            self.right_img.setAlignment(Qt.AlignCenter)
            mid_img_layout.addWidget(self.left_img)
            mid_img_layout.addWidget(self.right_img)
            self.img_num_label = QLabel("å½“å‰æ£€æµ‹ç»“æœï¼šå¾…æ£€æµ‹")
            self.img_num_label.setFont(font_main)
            mid_img_widget.setLayout(mid_img_layout)
            up_img_button = QPushButton("ä¸Šä¼ å›¾ç‰‡")
            det_img_button = QPushButton("å¼€å§‹æ£€æµ‹")
            up_img_button.clicked.connect(self.upload_img)
            det_img_button.clicked.connect(self.detect_img)
            up_img_button.setFont(font_main)
            det_img_button.setFont(font_main)
            up_img_button.setStyleSheet("QPushButton{color:white}"
                                        "QPushButton:hover{background-color: rgb(2,110,180);}"
                                        "QPushButton{background-color:rgb(48,124,208)}"
                                        "QPushButton{border:2px}"
                                        "QPushButton{border-radius:5px}"
                                        "QPushButton{padding:5px 5px}"
                                        "QPushButton{margin:5px 5px}")
            det_img_button.setStyleSheet("QPushButton{color:white}"
                                         "QPushButton:hover{background-color: rgb(2,110,180);}"
                                         "QPushButton{background-color:rgb(48,124,208)}"
                                         "QPushButton{border:2px}"
                                         "QPushButton{border-radius:5px}"
                                         "QPushButton{padding:5px 5px}"
                                         "QPushButton{margin:5px 5px}")
            img_detection_layout.addWidget(img_detection_title, alignment=Qt.AlignCenter)
            img_detection_layout.addWidget(mid_img_widget, alignment=Qt.AlignCenter)
            img_detection_layout.addWidget(self.img_num_label)
            img_detection_layout.addWidget(up_img_button)
            img_detection_layout.addWidget(det_img_button)
            img_detection_widget.setLayout(img_detection_layout)
    
            # ********************* è§†é¢‘è¯†åˆ«ç•Œé¢ *****************************
            vid_detection_widget = QWidget()
            vid_detection_layout = QVBoxLayout()
            vid_title = QLabel("è§†é¢‘æ£€æµ‹åŠŸèƒ½")
            vid_title.setFont(font_title)
            self.vid_img = QLabel()
            self.vid_img.setPixmap(QPixmap("images/UI/up.jpeg"))
            vid_title.setAlignment(Qt.AlignCenter)
            self.vid_img.setAlignment(Qt.AlignCenter)
            self.webcam_detection_btn = QPushButton("æ‘„åƒå¤´å®æ—¶ç›‘æµ‹")
            self.mp4_detection_btn = QPushButton("è§†é¢‘æ–‡ä»¶æ£€æµ‹")
            self.vid_stop_btn = QPushButton("åœæ­¢æ£€æµ‹")
            self.webcam_detection_btn.setFont(font_main)
            self.mp4_detection_btn.setFont(font_main)
            self.vid_stop_btn.setFont(font_main)
            self.webcam_detection_btn.setStyleSheet("QPushButton{color:white}"
                                                    "QPushButton:hover{background-color: rgb(2,110,180);}"
                                                    "QPushButton{background-color:rgb(48,124,208)}"
                                                    "QPushButton{border:2px}"
                                                    "QPushButton{border-radius:5px}"
                                                    "QPushButton{padding:5px 5px}"
                                                    "QPushButton{margin:5px 5px}")
            self.mp4_detection_btn.setStyleSheet("QPushButton{color:white}"
                                                 "QPushButton:hover{background-color: rgb(2,110,180);}"
                                                 "QPushButton{background-color:rgb(48,124,208)}"
                                                 "QPushButton{border:2px}"
                                                 "QPushButton{border-radius:5px}"
                                                 "QPushButton{padding:5px 5px}"
                                                 "QPushButton{margin:5px 5px}")
            self.vid_stop_btn.setStyleSheet("QPushButton{color:white}"
                                            "QPushButton:hover{background-color: rgb(2,110,180);}"
                                            "QPushButton{background-color:rgb(48,124,208)}"
                                            "QPushButton{border:2px}"
                                            "QPushButton{border-radius:5px}"
                                            "QPushButton{padding:5px 5px}"
                                            "QPushButton{margin:5px 5px}")
            self.webcam_detection_btn.clicked.connect(self.open_cam)
            self.mp4_detection_btn.clicked.connect(self.open_mp4)
            self.vid_stop_btn.clicked.connect(self.close_vid)
            vid_detection_layout.addWidget(vid_title)
            vid_detection_layout.addWidget(self.vid_img)
            # todo æ·»åŠ æ‘„åƒå¤´æ£€æµ‹æ ‡ç­¾é€»è¾‘
            self.vid_num_label = QLabel("å½“å‰æ£€æµ‹ç»“æœï¼š{}".format("ç­‰å¾…æ£€æµ‹"))
            self.vid_num_label.setFont(font_main)
            vid_detection_layout.addWidget(self.vid_num_label)
            vid_detection_layout.addWidget(self.webcam_detection_btn)
            vid_detection_layout.addWidget(self.mp4_detection_btn)
            vid_detection_layout.addWidget(self.vid_stop_btn)
            vid_detection_widget.setLayout(vid_detection_layout)
            # ********************* æ¨¡å‹åˆ‡æ¢ç•Œé¢ *****************************
            about_widget = QWidget()
            about_layout = QVBoxLayout()
            about_title = QLabel(WELCOME_SENTENCE)
            about_title.setFont(QFont('æ¥·ä½“', 18))
            about_title.setAlignment(Qt.AlignCenter)
            about_img = QLabel()
            about_img.setPixmap(QPixmap('images/UI/zhu.jpg'))
            self.model_label = QLabel("å½“å‰æ¨¡å‹ï¼š{}".format(self.model_path))
            self.model_label.setFont(font_main)
            change_model_button = QPushButton("åˆ‡æ¢æ¨¡å‹")
            change_model_button.setFont(font_main)
            change_model_button.setStyleSheet("QPushButton{color:white}"
                                              "QPushButton:hover{background-color: rgb(2,110,180);}"
                                              "QPushButton{background-color:rgb(48,124,208)}"
                                              "QPushButton{border:2px}"
                                              "QPushButton{border-radius:5px}"
                                              "QPushButton{padding:5px 5px}"
                                              "QPushButton{margin:5px 5px}")
    
            record_button = QPushButton("æŸ¥çœ‹å†å²è®°å½•")
            record_button.setFont(font_main)
            record_button.clicked.connect(self.check_record)
            record_button.setStyleSheet("QPushButton{color:white}"
                                        "QPushButton:hover{background-color: rgb(2,110,180);}"
                                        "QPushButton{background-color:rgb(48,124,208)}"
                                        "QPushButton{border:2px}"
                                        "QPushButton{border-radius:5px}"
                                        "QPushButton{padding:5px 5px}"
                                        "QPushButton{margin:5px 5px}")
            change_model_button.clicked.connect(self.change_model)
            about_img.setAlignment(Qt.AlignCenter)
            label_super = QLabel()  # todo æ›´æ¢ä½œè€…ä¿¡æ¯
            label_super.setText("<a href='https://blog.csdn.net/ECHOSON'>ä½œè€…ï¼šè‚†åäºŒ</a>")
            label_super.setFont(QFont('æ¥·ä½“', 16))
            label_super.setOpenExternalLinks(True)
            label_super.setAlignment(Qt.AlignRight)
            about_layout.addWidget(about_title)
            about_layout.addStretch()
            about_layout.addWidget(about_img)
            about_layout.addWidget(self.model_label)
            about_layout.addStretch()
            about_layout.addWidget(change_model_button)
            about_layout.addWidget(record_button)
            about_layout.addWidget(label_super)
            about_widget.setLayout(about_layout)
            self.left_img.setAlignment(Qt.AlignCenter)
    
            self.addTab(about_widget, 'ä¸»é¡µ')
            self.addTab(img_detection_widget, 'å›¾ç‰‡æ£€æµ‹')
            self.addTab(vid_detection_widget, 'è§†é¢‘æ£€æµ‹')
    
            self.setTabIcon(0, QIcon(ICON_IMAGE))
            self.setTabIcon(1, QIcon(ICON_IMAGE))
            self.setTabIcon(2, QIcon(ICON_IMAGE))


æˆ‘ä»¬åœ¨ä»£ç çš„è¿™ä¸ªä½ç½®å¯ä»¥æ›´æ¢è¿™ä¸ªç³»ç»Ÿçš„é»˜è®¤æ ‡é¢˜å’Œé»˜è®¤çš„logoå›¾åƒã€‚

![image-20240818144216340](https://i-blog.csdnimg.cn/blog_migrate/d20944634c4d4b396161a73a3a133747.png)

ä»¥åŠåœ¨è¿™ä¸ªä½ç½®å¯ä»¥æ›´æ¢ä¸ºä½ è‡ªå·±çš„æ¨¡å‹ã€‚

![image-20240818144234499](https://i-blog.csdnimg.cn/blog_migrate/e93bb183c872ca3a654344fb35450458.png)
